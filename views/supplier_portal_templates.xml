<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_layout">
        <t t-call="web.frontend_layout">
            <t t-set="no_header" t-value="True"/>
            <t t-set="no_footer" t-value="True"/>
            <!-- Viewport esencial para que el CSS responsivo funcione en móviles -->
            <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>
            
            <t t-set="head">
                <t t-call-assets="web.assets_frontend" t-css="true" t-js="true"/>
                <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&amp;display=swap" rel="stylesheet"/>
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"/>
            </t>
            <div class="supplier-portal-body">
                <t t-out="0"/>
            </div>
        </t>
    </template>

    <template id="supplier_portal_view">
        <t t-call="stock_lot_packing_import.portal_layout">
            
            <!-- Payload de datos para JS -->
            <div id="portal-data-store" style="display:none;" t-att-data-payload="portal_json"></div>

            <div class="o_portal_wrapper">
                <!-- HEADER ESTATICO -->
                <header class="o_portal_header">
                    <div class="brand">
                        <!-- ICONO DE EMPRESA -->
                        <img src="/stock_lot_packing_import/static/description/icon.png" 
                             alt="Logo" 
                             class="me-3" 
                             style="height: 40px; width: auto; object-fit: contain;"/>
                        
                        <span>PORTAL <span class="ms-1" data-i18n="header_provider">PROVEEDOR</span></span>
                    </div>

                    <!-- CONTROLES DERECHOS AGRUPADOS (Para CSS Responsivo) -->
                    <div class="header-controls">
                        <!-- SELECTOR DE IDIOMA -->
                        <div class="lang-selector-wrapper">
                            <i class="fa fa-globe text-muted me-2"></i>
                            <select id="lang-selector" class="lang-select">
                                <option value="en" selected="selected">EN</option>
                                <option value="es">ES</option>
                                <option value="pt">PT</option>
                                <option value="it">IT</option>
                                <option value="zh">ZH</option>
                            </select>
                        </div>

                        <!-- INFO DE ORDEN -->
                        <div class="po-info">
                            <div><span class="label" data-i18n="po_label">Orden:</span> <span class="value" t-esc="picking.origin or 'N/A'"/></div>
                            <div><span class="label" data-i18n="receipt_label">Recep:</span> <span class="value" t-esc="picking.name"/></div>
                        </div>
                    </div>
                </header>

                <div class="o_portal_container">
                    
                    <!-- SECCIÓN: DATOS DE EMBARQUE -->
                    <div class="shipment-card">
                        <div class="card-header">
                            <i class="fa fa-ship fa-lg"></i>
                            <h3 data-i18n="shipment_data_title">Datos de Embarque</h3>
                        </div>
                        <div class="card-body" id="shipment-info-form">
                            
                            <div class="modern-form-grid">
                                <!-- Documentación -->
                                <div class="form-group">
                                    <label><i class="fa fa-file-invoice"/> <span data-i18n="lbl_invoice">No. de Factura</span></label>
                                    <input type="text" id="h-invoice" class="form-control" data-i18n-placeholder="ph_invoice" placeholder="Ej. INV-2024-001"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-calendar"/> <span data-i18n="lbl_date">Fecha Embarque</span></label>
                                    <input type="date" id="h-date" class="form-control"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-file-contract"/> <span data-i18n="lbl_proforma">No. Proforma (PI)</span></label>
                                    <input type="text" id="h-proforma" class="form-control" data-i18n-placeholder="ph_proforma" placeholder="Ej. PI-9920"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-file-alt"/> <span data-i18n="lbl_bl">No. B/L</span></label>
                                    <input type="text" id="h-bl" class="form-control" data-i18n-placeholder="ph_bl" placeholder="Ej. COSU123456"/>
                                </div>

                                <!-- Logística -->
                                <div class="section-divider"><span data-i18n="sec_logistics">Logística</span></div>

                                <div class="form-group">
                                    <label><i class="fa fa-map-marker-alt"/> <span data-i18n="lbl_origin">Origen (Puerto)</span></label>
                                    <input type="text" id="h-origin" class="form-control" data-i18n-placeholder="ph_origin" placeholder="Ej. Shanghai"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-map-marker-alt"/> <span data-i18n="lbl_dest">Destino (Puerto)</span></label>
                                    <input type="text" id="h-dest" class="form-control" data-i18n-placeholder="ph_dest" placeholder="Ej. Manzanillo"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-globe"/> <span data-i18n="lbl_country">País Origen</span></label>
                                    <input type="text" id="h-country" class="form-control" data-i18n-placeholder="ph_country" placeholder="Ej. China"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-ship"/> <span data-i18n="lbl_vessel">Buque / Viaje</span></label>
                                    <input type="text" id="h-vessel" class="form-control" data-i18n-placeholder="ph_vessel" placeholder="Ej. MAERSK SEALAND"/>
                                </div>
                                
                                <div class="form-group">
                                    <label><i class="fa fa-handshake"/> <span data-i18n="lbl_incoterm">Incoterm / Pago</span></label>
                                    <input type="text" id="h-incoterm" class="form-control" data-i18n-placeholder="ph_incoterm" placeholder="Ej. CIF / T/T"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-info-circle"/> <span data-i18n="lbl_status">Estatus</span></label>
                                    <select id="h-status" class="form-control">
                                        <option value="" data-i18n="opt_select">Seleccionar...</option>
                                        <option value="En Producción" data-i18n="opt_production">En Producción</option>
                                        <option value="En Puerto Origen" data-i18n="opt_origin_port">En Puerto Origen</option>
                                        <option value="En Tránsito" data-i18n="opt_transit">En Tránsito</option>
                                        <option value="En Puerto Destino" data-i18n="opt_dest_port">En Puerto Destino</option>
                                    </select>
                                </div>

                                <!-- Carga -->
                                <div class="section-divider"><span data-i18n="sec_cargo">Detalles de Carga</span></div>

                                <div class="form-group">
                                    <label><i class="fa fa-box-open"/> <span data-i18n="lbl_container">No. Contenedor</span></label>
                                    <input type="text" id="h-cont-no" class="form-control" data-i18n-placeholder="ph_container" placeholder="Ej. MSKU1234567"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-lock"/> <span data-i18n="lbl_seal">No. Sello</span></label>
                                    <input type="text" id="h-seal" class="form-control" data-i18n-placeholder="ph_seal" placeholder="Ej. 123456"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-truck-loading"/> <span data-i18n="lbl_cont_type">Tipo Contenedor</span></label>
                                    <input type="text" id="h-type" class="form-control" data-i18n-placeholder="ph_cont_type" placeholder="Ej. 40HC, 20GP"/>
                                </div>
                                
                                <div class="form-group">
                                    <label><i class="fa fa-boxes"/> <span data-i18n="lbl_packages">Total Paquetes</span></label>
                                    <input type="number" id="h-pkgs" class="form-control" placeholder="0"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-weight-hanging"/> <span data-i18n="lbl_weight">Peso Bruto (kg)</span></label>
                                    <input type="number" step="0.01" id="h-weight" class="form-control" placeholder="0.00"/>
                                </div>
                                <div class="form-group">
                                    <label><i class="fa fa-cube"/> <span data-i18n="lbl_volume">Volumen (m³)</span></label>
                                    <input type="number" step="0.01" id="h-volume" class="form-control" placeholder="0.00"/>
                                </div>

                                <div class="form-group full-width">
                                    <label><i class="fa fa-align-left"/> <span data-i18n="lbl_desc">Descripción Mercancía</span></label>
                                    <textarea id="h-desc" class="form-control" rows="2" data-i18n-placeholder="ph_desc" placeholder="Descripción general de la carga..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TITULO PACKING LIST -->
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h4 class="text-white m-0"><i class="fa fa-list-ul me-2 text-warning"/> <span data-i18n="pl_title">Detalle de Placas (Packing List)</span></h4>
                    </div>

                    <div class="alert alert-dark border border-secondary text-light mb-4" style="background: #1a1a1a;">
                        <small><i class="fa fa-info-circle text-warning me-1"/> <span data-i18n="pl_instruction">Ingrese las dimensiones de cada placa. El área se calculará automáticamente.</span></small>
                    </div>

                    <!-- TABLAS JS (Contenedor vacío que el JS rellena) -->
                    <div id="portal-rows-container">
                        <div class="text-center py-5 text-muted">
                            <i class="fa fa-circle-o-notch fa-spin fa-2x"></i>
                            <p class="mt-2" data-i18n="loading">Cargando...</p>
                        </div>
                    </div>
                </div>

                <!-- FOOTER -->
                <div class="submit-footer">
                    <!-- Estructura dividida en DIVs para mejor manejo flexbox en móvil -->
                    <div class="summary">
                        <div><span data-i18n="footer_total_plates">Total Placas:</span> <span id="total-plates">0</span></div>
                        <div>
    <span data-i18n="footer_total_area">Total Área:</span> 
    <span id="total-area">0.00</span> 
    <span>m²</span>
</div>
                    </div>
                    <button id="btn-submit-pl" class="btn-primary-custom" disabled="disabled">
                        <i class="fa fa-paper-plane me-2"/> <span data-i18n="btn_submit">Guardar y Enviar</span>
                    </button>
                </div>
            </div>
        </t>
    </template>

    <template id="portal_not_found">
        <t t-call="stock_lot_packing_import.portal_layout">
            <div class="container text-center py-5">
                <h1 class="display-1 text-danger">404</h1>
                <p class="lead">Invalid Link.</p>
            </div>
        </t>
    </template>

    <template id="portal_expired">
        <t t-call="stock_lot_packing_import.portal_layout">
            <div class="container text-center py-5">
                <h1 class="display-1 text-warning"><i class="fa fa-clock-o"/></h1>
                <p class="lead">Link Expired.</p>
            </div>
        </t>
    </template>
</odoo>