<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_layout">
        <t t-call="web.frontend_layout">
            <t t-set="no_header" t-value="True"/>
            <t t-set="no_footer" t-value="True"/>
            <t t-set="head">
                <t t-call-assets="web.assets_frontend" t-css="true" t-js="true"/>
                <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600" rel="stylesheet"/>
            </t>
            <div class="supplier-portal-body">
                <t t-out="0"/>
            </div>
        </t>
    </template>

    <template id="supplier_portal_view">
        <t t-call="stock_lot_packing_import.portal_layout">
            <!-- DATA ISLAND: Datos para JS -->
            <script type="text/javascript">
                window.portalData = {
                    products: <t t-out="products_json"/>,
                    token: '<t t-esc="token"/>',
                    poName: '<t t-esc="picking.origin or &#34;&#34;"/>',
                    pickingName: '<t t-esc="picking.name"/>'
                };
            </script>

            <div class="o_portal_wrapper">
                <!-- HEADER ESTATICO -->
                <header class="o_portal_header">
                    <div class="brand">
                        <i class="fa fa-cubes me-2"/>PORTAL <span class="ms-1">PROVEEDOR</span>
                    </div>
                    <div class="po-info">
                        <div><span class="label">Orden de Compra:</span> <span class="value" t-esc="picking.origin or ''"/></div>
                        <div><span class="label">Recepción:</span> <span class="value" t-esc="picking.name"/></div>
                    </div>
                </header>

                <!-- CONTENEDOR PRINCIPAL -->
                <div class="o_portal_container pb-5 mb-5">
                    <div class="alert alert-info bg-dark border-secondary text-light mb-4">
                        <i class="fa fa-info-circle me-2 text-warning"/>
                        Por favor ingrese las dimensiones y detalles de cada placa o bloque. No necesita agrupar, el sistema lo hará automáticamente.
                    </div>

                    <!-- AQUÍ EL JS DIBUJARÁ LAS TABLAS -->
                    <div id="portal-rows-container">
                        <div class="text-center py-5 text-muted">
                            <i class="fa fa-circle-o-notch fa-spin fa-2x"></i>
                            <p class="mt-2">Inicializando interfaz...</p>
                        </div>
                    </div>
                </div>

                <!-- FOOTER ESTATICO -->
                <div class="submit-footer">
                    <div class="summary">
                        Total Placas: <span id="total-plates">0</span> | 
                        Total Área: <span id="total-area">0.00</span> m²
                    </div>
                    <button id="btn-submit-pl" class="btn-primary-custom" disabled="disabled">
                        <i class="fa fa-paper-plane me-2"/> Enviar Packing List
                    </button>
                </div>
            </div>
        </t>
    </template>

    <template id="portal_not_found">
        <t t-call="stock_lot_packing_import.portal_layout">
            <div class="container text-center py-5">
                <h1 class="display-1 text-danger">404</h1>
                <p class="lead">Enlace no válido.</p>
            </div>
        </t>
    </template>

    <template id="portal_expired">
        <t t-call="stock_lot_packing_import.portal_layout">
            <div class="container text-center py-5">
                <h1 class="display-1 text-warning"><i class="fa fa-clock-o"/></h1>
                <p class="lead">Este enlace ha expirado.</p>
            </div>
        </t>
    </template>
</odoo>